# 工具节点
## 什么是工具节点？
工具节点是Magic Flow中的一种功能强大的节点，它允许您在工作流中调用和使用各种预设工具。就像是一个多功能瑞士军刀，工具节点可以帮助您执行特定任务，如数据处理、信息查询或自动化操作。您可以通过自然语言描述（大模型调用）或直接设置参数（参数调用）两种方式来使用这些工具，满足不同场景的需求。

**图片说明：**

工具节点界面主要由调用模式选择区域和参数配置区域组成。顶部可以选择"大模型调用"或"参数调用"两种不同的模式，下方则是系统自定义输入参数配置区域，支持添加多个参数及其表达式。
![工具节点](/static/img/Tool.png)

## 为什么需要工具节点？
在构建智能工作流时，您常常需要执行一些标准化的任务或调用特定的功能。工具节点的存在就是为了解决这个问题：
1. **功能扩展**：扩展Magic Flow的能力边界，使工作流能够执行更多专业化任务
2. **标准化操作**：提供统一的接口调用各类工具，简化工作流设计
3. **灵活调用**：支持多种调用方式，即使没有技术背景也能轻松使用
4. **流程自动化**：将人工操作转化为自动化流程，提高效率和一致性
## 适用场景
工具节点适用于多种场景，包括但不限于：
1. **信息查询**：调用搜索工具获取实时信息或专业知识
2. **数据处理**：使用数据转换工具处理和格式化工作流中的数据
3. **自动化操作**：触发自动化任务，如发送通知、创建日程等
4. **智能助手增强**：为聊天机器人添加查询天气、翻译文本等实用工具能力
## 节点参数说明
### 输入说明
工具节点的输入参数主要分为两类：调用模式设置和工具参数配置。
|参数名称|说明|是否必填|默认值|
|---|---|---|---|
|调用模式|选择工具的调用方式，包括【大模型调用】和【参数调用】|是|大模型调用|
|选择工具|选择要使用的工具名称|是|无|
|模型|选择【大模型调用】时，选择要使用的模型信息|是|GPT-4o|
|提示词|使用提示词来给大模型，确保使用准确，支持通过@使用变量|否|无|

### 输出说明
工具节点执行后，会输出以下内容：
|输出名称|说明|示例|
|---|---|---|
|输出文本|工具执行的结果文本|"当前北京天气：晴，25°C"|
|执行状态|工具执行的状态，成功或失败|"success"|
|错误信息|如果执行失败，则包含错误详情|"API调用超时"|

## 使用说明
### 基本配置步骤
1. **添加工具节点**
    1. 从节点面板中拖拽"工具"节点到工作流画布
    2. 将节点与工作流中的其他节点连接起来
2. **选择调用模式**
    1. 在节点配置面板中选择"大模型调用"或"参数调用"
    2. 大模型调用：适合通过自然语言描述使用工具
    3. 参数调用：适合通过直接配置参数使用工具
3. **配置参数**
    1. 点击"添加"按钮添加工具所需的参数
    2. 填写参数名，设置是否必填
    3. 选择适当的表达式类型（如文本、数字等）
    4. 填写参数值或表达式
4. **设置嵌套参数（如需）**
    1. 对于复杂工具，可以点击参数右侧的"+"按钮添加子参数
    2. 按照同样的方式配置子参数
5. **配置输出**
    1. 在"输出"部分选择输出格式（默认为文本）
    2. 可根据需要启用或禁用某些输出项
### 进阶技巧
1. **使用变量引用**
    1. 勾选"使用@流加变量"选项，可以在参数值中使用@符号引用工作流中的变量
    2. 示例：在参数值中输入"@用户问题"，将使用工作流中的"用户问题"变量值
2. **参数的动态计算**
    1. 在表达式中可以使用简单的计算公式
    2. 示例："{{count + 1}}"将自动计算count变量值加1的结果
3. **条件判断中使用工具结果**
    1. 工具节点的输出可以作为条件判断节点的输入
    2. 可以根据工具执行结果选择不同的流程分支
## 注意事项
### 参数配置注意事项
1. **参数命名规范**
    1. 参数名应简洁明了，反映参数用途
    2. 避免使用空格和特殊字符，推荐使用英文字母、数字和下划线
2. **必填参数处理**
    1. 所有标记为"必填"的参数必须配置有效值
    2. 如果必填参数没有值，工具将无法正常执行
3. **参数值格式**
    1. 确保参数值符合工具的要求格式
    2. 日期、数字等特殊类型数据需要按照指定格式提供
### 性能与限制
1. **执行超时**
    1. 工具调用有默认的超时限制（通常为30秒）
    2. 长时间运行的工具可能会因超时而失败
2. **调用频率**
    1. 部分工具可能有调用频率限制
    2. 避免在短时间内频繁调用同一工具
## 常见问题
### 问题1：工具节点执行失败怎么办？
**解决方案**：当工具节点执行失败时，可以通过以下步骤排查：
1. 检查所有必填参数是否已正确配置
2. 查看错误信息，了解具体失败原因
3. 确认参数格式是否正确，特别是日期、JSON等特殊格式
4. 检查网络连接是否正常（针对需要网络访问的工具）
5. 如果使用变量引用，确认变量存在且有值
### 问题2：如何在大模型调用和参数调用之间选择？
**解决方案**：选择调用模式的建议：
- **大模型调用**：适合需要自然语言理解的场景，例如当您希望通过描述性语言来使用工具，或工具输入参数较为复杂时
- **参数调用**：适合参数明确、需求固定的场景，可以获得更稳定、可预测的结果，适合流程化、标准化的任务
## 常见搭配节点
|**节点类型**|**搭配原因**|
|---|---|
|大模型调用节点|工具节点可以作为大模型的扩展能力，处理专业任务|
|条件分支节点|根据工具执行结果决定后续流程走向|
|消息回复节点|将工具执行结果作为回复内容展示给用户|
|变量保存节点|保存工具执行结果，供后续节点使用|
