
# 基本介绍
【工具】与【子流程】实际上本质是一样的，只是用法和场景有所不同。

【子流程】：一般用于拆分主流程，允许将主流程的一部分功能模块抽象成一个独立的工具能力，从而避免一个流程主体过大，进一步提升维护效率

【工具】：而工具一般用于被大模型调用，当然也允许以工具节点的形式存在

**对于「工具」有几种概念需要了解一下**

**系统自定义参数**：当工具作为工具节点的形式存在时，定义工具节点的自定义入参

**大模型参数**：当被大模型调用时，定义大模型调用时的入参

**输出**：工具调用完后返回的数据

## 一、设计你想要得到的效果
SRM 系统在实际的业务过程中使用广泛，用户需要频繁的去查找 SRM 知识库进行疑难解答，但是又不想重复设置多个 AI 助理，希望在一个 AI 助理上支持多个系统的知识问答，那么我们就需要将用户查找 SRM 知识库的能力抽象成一个独立的工具给大模型调用即可。

基于以上的场景目标我们设计的工作流会包含以下几个部分：

1、创建一个知识助理工具集

2、在对应的知识工具集下添加 **srm_knowledge_search** 工具

3、在对应的 AI 助理的【大模型节点】上配置上对应工具即可

## 二、创建知识助理工具集
1. 登录 [Magic](https://www.letsmagic.cn/login)平台。（如果私有化部署则登录对应私有化登录平台）
2. 在左边菜单栏点击【AI 助理】，右边点击【创建工具集】
3. 上传工具集图片，并填写助理的名称和对它的简单描述
4. 点击【知识助理工具集】，右边点击【添加工具】
5. 输入【srm_knowledge_search】，并增加对应描述，如：“检索 SRM 知识库内容”

![工具截图](/static/img/tool-1.png)
![工具截图](/static/img/tool-2.png)

## 三、编排工作流
### 1、点击创建【开始节点】
1.1 点击【添加参数】

1.2 输入对应大模型参数输入内容如下图

![工具截图](/static/img/tool-3.png)

### 2、连接并创建【向量搜索节点】
2.1 选择知识库：固定值，选择供应链知识库

2.2 搜索关键词：通过 @ 引用开始节点问题

2.3 元数据匹配：设置对应的参数值 

（参数名：**knowledge_base_id**、参数值：**固定值、716406779765358592**）

![工具截图](/static/img/tool-4.png)

### 3、连接并创建【大模型节点】
3.1 模型区域，选择已支持的大模型节点，其他参数保持不变，同时也开启视觉理解能力（这里 默认选择 GPT-4o） 

![工具截图](/static/img/tool-5.png)

3.2、输入区域， System 输入框填写输入给大模型的提示词，User 区域 通过 @引用**开始节点的问题**和**向量搜索节点的片段列表**

3.3、开启自动加载记忆
```
#角色
数据处理专家
#任务
根据给定问题选择关联性较高的若干片段，然后组织最恰当的答案。
#目标
答案要基于所选择的关联性较高的若干片段，在此基础上适当扩展，符合问题Q的逻辑，语法通顺流畅。
#要求
1、根据给定问题 Q，从fragment选项列表中选择最相关的若干个片段；
2、必须确保所选片段是和问题有关联的。如果你认为所有片段和问题都没有关联的话，查询不到相关信息。那么你就回答"检索不到该内容"；
3、回答不能生硬，可以适当根据答案润色一下，使得回答更通畅，但不得改变原答案的主旨；
4、如果所有fragment关联性都比较低的话，查询不到相关信息那么认为不存在答案，则输出"检索不到该内容"；
5、你的回答不能遗漏片段中的图片，需要一起展示渲染图片在你的回答内容中；

#返回格式
只返回答案；使用漂亮的 markdown 格式返回。
#流程
你需要严格按照以下流程思考并执行每一步：
1、接收一个问题（Q）；
2、从fragment列表中选择关联性较高的若干个片段；根据第二步选择的关联性较高的若干个片段，根据问题Q组织答案，并且返回；
3、答案可以稍加润色，使得语法通畅；
```
![工具截图](/static/img/tool-6.png)
### 4、连接并创建【结束节点】
4.1、添加对应结束参数值（参数名：**response**、参数值：**固定值，并通过 @引用大模型文本字符串**）
      
![工具截图](/static/img/tool-7.png)

### 5、工具发布
5.1、点击发布，填上对应的版本命名和版本描述即可

![工具截图](/static/img/tool-8.png)

### 6、AI 知识助理引用

6.1、选择需要支持 SRM 问答的 AI 助理，在大模型节点点击【添加工具】

6.2、选择【知识助理工具集】，添加【srm_knowledge_search】工具，也可以通过搜索栏快速搜索
![工具截图](/static/img/tool-9.png)
![工具截图](/static/img/tool-10.png)

---
完成上述配置，对应的 AI 助理就能支持查询 SRM知识库的内容啦。